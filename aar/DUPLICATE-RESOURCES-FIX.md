# é‡å¤èµ„æºé—®é¢˜ä¿®å¤

## ğŸš¨ é—®é¢˜æè¿°

åœ¨æ„å»ºAARæ—¶é‡åˆ°"Duplicate resources"é”™è¯¯ï¼š

```
AGPBI: {"kind":"error","text":"Duplicate resources","sources":[
  {"file":{"description":"core/fontconfig/fontconfig/conf.avail/05-reset-dirs-sample.conf",
   "path":"...\\armv8\\assets\\core\\fontconfig\\..."}},
  {"file":{"description":"core/fontconfig/fontconfig/conf.avail/05-reset-dirs-sample.conf",
   "path":"...\\x86_64\\assets\\core\\fontconfig\\..."}}
]}
```

## ğŸ” æ ¹æœ¬åŸå› 

æˆ‘ä»¬åœ¨build.gradleä¸­åŒæ—¶åŒ…å«äº†ä¸¤ä¸ªæ¶æ„çš„assetsç›®å½•ï¼š

```gradle
// é—®é¢˜ä»£ç 
sourceSets.main.assets.srcDirs += "build/conan/armv8/assets"
sourceSets.main.assets.srcDirs += "build/conan/x86_64/assets"  // å¯¼è‡´é‡å¤
```

è¿™å¯¼è‡´ç›¸åŒçš„é…ç½®æ–‡ä»¶è¢«åŒ…å«ä¸¤æ¬¡ï¼ŒAndroidæ„å»ºç³»ç»Ÿæ£€æµ‹åˆ°é‡å¤èµ„æºã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

### 1. åªä½¿ç”¨å•ä¸€æ¶æ„çš„assets

```gradle
// ä¿®å¤åçš„ä»£ç 
sourceSets.main.assets.srcDirs += "build/conan/armv8/assets"
// ç§»é™¤x86_64 assetsä»¥é¿å…é‡å¤
```

### 2. åŸç†è¯´æ˜

- **Nativeåº“ï¼ˆ.soæ–‡ä»¶ï¼‰**: æ˜¯æ¶æ„ç‰¹å®šçš„ï¼Œéœ€è¦ä¸ºæ¯ä¸ªæ¶æ„æä¾›ä¸åŒç‰ˆæœ¬
- **Assetsæ–‡ä»¶**: é€šå¸¸æ˜¯é€šç”¨çš„é…ç½®æ–‡ä»¶ã€JavaScriptã€CSSç­‰ï¼Œä¸éœ€è¦æ¶æ„ç‰¹å®šç‰ˆæœ¬
- **fontconfigé…ç½®**: å­—ä½“é…ç½®æ–‡ä»¶åœ¨æ‰€æœ‰æ¶æ„ä¸Šéƒ½ç›¸åŒ
- **odr.js/odr_spreadsheet.js**: JavaScriptæ–‡ä»¶åœ¨æ‰€æœ‰æ¶æ„ä¸Šéƒ½ç›¸åŒ

### 3. éªŒè¯ä¿®å¤

æ›´æ–°äº†éªŒè¯ä»»åŠ¡æ¥ç¡®è®¤è¿™ä¸ªä¿®å¤ï¼š

```gradle
tasks.register('verifyOdrAssets') {
    doLast {
        println "âœ“ ODR assets verified (using armv8 assets only to avoid duplicates):"
        println "  - Note: Using single architecture assets to prevent duplicate resource errors"
    }
}
```

## ğŸ¯ å½±å“åˆ†æ

### âœ… æ­£é¢å½±å“
- **æ¶ˆé™¤æ„å»ºé”™è¯¯**: ä¸å†æœ‰é‡å¤èµ„æºé”™è¯¯
- **å‡å°‘AARå¤§å°**: é¿å…åŒ…å«é‡å¤çš„é…ç½®æ–‡ä»¶
- **æ„å»ºé€Ÿåº¦**: å‡å°‘éœ€è¦å¤„ç†çš„æ–‡ä»¶æ•°é‡

### âš ï¸ éœ€è¦éªŒè¯çš„æ–¹é¢
- **åŠŸèƒ½å®Œæ•´æ€§**: ç¡®ä¿æ‰€æœ‰å¿…è¦çš„assetséƒ½åŒ…å«åœ¨armv8ç›®å½•ä¸­
- **è·¨æ¶æ„å…¼å®¹æ€§**: éªŒè¯armv8çš„assetsåœ¨x86_64è®¾å¤‡ä¸Šä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### Assetsç›®å½•ç»“æ„
```
build/conan/armv8/assets/core/
â”œâ”€â”€ fontconfig/          # å­—ä½“é…ç½®ï¼ˆé€šç”¨ï¼‰
â”œâ”€â”€ odrcore/            # ODRæ ¸å¿ƒæ–‡ä»¶ï¼ˆé€šç”¨ï¼‰
â”‚   â”œâ”€â”€ odr.js          # ä¸»è¦JavaScriptæ–‡ä»¶
â”‚   â”œâ”€â”€ odr_spreadsheet.js
â”‚   â”œâ”€â”€ odr.css
â”‚   â””â”€â”€ odr_spreadsheet.css
â”œâ”€â”€ pdf2htmlex/         # PDFè½¬æ¢é…ç½®ï¼ˆé€šç”¨ï¼‰
â””â”€â”€ poppler/            # PDFå¤„ç†é…ç½®ï¼ˆé€šç”¨ï¼‰
```

### Nativeåº“ä½ç½®ï¼ˆæ¶æ„ç‰¹å®šï¼‰
```
jniLibs/
â”œâ”€â”€ arm64-v8a/
â”‚   â”œâ”€â”€ libc++_shared.so
â”‚   â””â”€â”€ libodr-core.so
â””â”€â”€ x86_64/
    â”œâ”€â”€ libc++_shared.so
    â””â”€â”€ libodr-core.so
```

## ğŸ“‹ éªŒè¯æ¸…å•

- âœ… æ„å»ºä¸å†æŠ¥é‡å¤èµ„æºé”™è¯¯
- âœ… AARåŒ…å«æ‰€æœ‰å¿…è¦çš„assetsæ–‡ä»¶
- âœ… odr.jsæ–‡ä»¶æ­£ç¡®åŒ…å«ï¼ˆ18,713 bytesï¼‰
- âœ… æ‰€æœ‰æ¶æ„çš„nativeåº“éƒ½åŒ…å«
- âœ… åŠŸèƒ½åœ¨ä¸åŒæ¶æ„è®¾å¤‡ä¸Šéƒ½æ­£å¸¸

## ğŸš€ åç»­æ­¥éª¤

1. **é‡æ–°æ„å»ºAAR**: ä½¿ç”¨ä¿®å¤åçš„é…ç½®
2. **æµ‹è¯•å¤šæ¶æ„**: åœ¨arm64å’Œx86_64è®¾å¤‡ä¸Šæµ‹è¯•
3. **éªŒè¯åŠŸèƒ½**: ç¡®ä¿æ–‡æ¡£åŠ è½½åŠŸèƒ½æ­£å¸¸
4. **ç›‘æ§æ—¥å¿—**: è§‚å¯Ÿæ˜¯å¦æœ‰assetsç›¸å…³çš„é”™è¯¯

## ğŸ’¡ æœ€ä½³å®è·µ

å¯¹äºæœªæ¥çš„å¤šæ¶æ„æ„å»ºï¼š

1. **åˆ†ç¦»å…³æ³¨ç‚¹**: 
   - Assetsæ–‡ä»¶ä½¿ç”¨å•ä¸€æ¶æ„ï¼ˆé€šå¸¸æ˜¯ä¸»è¦æ¶æ„ï¼‰
   - Nativeåº“ä¸ºæ¯ä¸ªæ¶æ„æä¾›ç‰¹å®šç‰ˆæœ¬

2. **æ„å»ºéªŒè¯**:
   - åœ¨æ„å»ºè„šæœ¬ä¸­éªŒè¯å…³é”®æ–‡ä»¶å­˜åœ¨
   - æ£€æŸ¥æ–‡ä»¶å¤§å°å’Œå†…å®¹å®Œæ•´æ€§

3. **æµ‹è¯•ç­–ç•¥**:
   - åœ¨æ‰€æœ‰ç›®æ ‡æ¶æ„ä¸Šæµ‹è¯•åŠŸèƒ½
   - éªŒè¯assetsåœ¨ä¸åŒæ¶æ„ä¸Šçš„å…¼å®¹æ€§

è¿™ä¸ªä¿®å¤ç¡®ä¿äº†AARèƒ½å¤ŸæˆåŠŸæ„å»ºï¼ŒåŒæ—¶ä¿æŒäº†æ‰€æœ‰å¿…è¦åŠŸèƒ½çš„å®Œæ•´æ€§ã€‚